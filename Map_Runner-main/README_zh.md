# Map Runner - 機器人導航測試應用

## 專案概覽

Map Runner 是一個基於 Flutter 的工具型應用程式，旨在測試與控制機器人的導航功能。它提供了一個簡單的使用者介面，讓使用者可以連接到機器人的 API、獲取可用的地圖列表和機器人列表，並命令指定的機器人在選定的地圖上，按照一系列的地點進行導航。

本應用主要作為機器人導航任務的測試與偵錯工具。

## 主要功能

- **動態 API 金鑰設定**：允許使用者在執行時輸入並套用 API 金鑰。
- **動態資料獲取**：從後端伺服器獲取所有可用的導航地圖和機器人列表。
- **下拉式選單選擇**：方便地從下拉選單中選擇目標機器人和地圖。
- **自動化導航流程**：
  - 透過 API 初始化一個「新任務」。
  - 遍歷選定地圖上的所有預設地點 (`rLocations`)。
  - 為每個地點發送「導航」命令。
  - 輪詢機器人的 `moveStatus` 以等待其到達每個地點。
  - 在訪問完所有地點後，結束任務。
- **即時日誌記錄**：在一個可滾動、可複製的文字視窗中，詳細顯示所有操作。
- **穩健的 API 處理**：
  - 當 API 回應地圖資料正在生成時，能優雅地處理並自動重試。
  - 安全地解析可能為 `null` 或格式不正確的 API 資料以防止程式崩潰。
- **HTML 報告生成**：在任務完成（無論成功或失敗）後，可以產生並分享一份詳細的 HTML 報告，其中包含任務摘要和每個導航路徑點的時間記錄表。

## 使用說明

1.  **啟動應用程式**。
2.  **設定 API 金鑰**：
    -   在「輸入 API 金鑰」欄位中，輸入您的 `Basic` 認證權杖。
    -   按下「套用」按鈕。
    -   應用程式會使用此金鑰來獲取可用的機器人與地圖列表。請在下方的日誌視窗中確認是否成功。
3.  **選擇機器人**：
    -   從「選擇機器人 SN」下拉選單中選擇一台目標機器人。
4.  **選擇地圖**：
    -   從「選擇 MapName」下拉選單中選擇一張地圖。
5.  **開始導航**：
    -   按下「開始循環導航」按鈕。
    -   機器人將會開始執行它的導航序列。
6.  **監控進度**：
    -   觀察日誌視窗以獲取機器人進度的即時更新。
7.  **產生報告**：
    -   導航任務結束後，「產生報告」按鈕將會變為可點擊狀態。
    -   點擊它即可產生並分享一份詳細的 HTML 任務報告。

## 專案結構

本專案遵循標準的 Flutter 應用程式結構，所有 Dart 原始碼都位於 `lib/` 目錄下。

```
lib/
├── main.dart                  # 應用程式主要進入點及導航頁面的 UI。
├── api_service.dart           # 處理所有對後端 API 的 HTTP 請求。
├── navigation_controller.dart # 包含導航流程的核心業務邏輯。
├── report_generator.dart      # 包含產生 HTML 報告的邏輯。
│
├── models/
│   ├── location_model.dart    # 場域和地圖的資料模型。
│   ├── robot_info_model.dart  # 機器人狀態的資料模型。
│   └── report_model.dart      # 導航報告的資料模型。
│
└── widgets/
    └── log_console.dart       # 用於顯示日誌的簡易、可重用元件。
```
